# hindsight-mcp - an mcp server for ai-assisted coding that leverages development history

## Background and task

We are building an mcp server ("hindsight-mcp") that will:
	- consolidate various "development data" that is stored locally (git logs, test results, and GitHub copilot logs) into a well-structured, searchable SQLite database
	- make this SQLite database accessible to an llm through an mcp tool call within vscode

**TASK: Scaffold the cargo workspace (crates and their key dependencies are outlined below) for the hindsight-mcp project, ensuring that each crate has its own benches, fuzz and tests folder.**

Ensure that the workspace has a suitable .gitignore, noting that we are developing on a macOS machine


### Crates and their key dependencies for hindsight-mcp cargo workspace

- **hindsight-mcp**: binary crate (executable) that bridges between AI and development history.  This is the mcp server we are building.
	- rust-mcp-sdk
	- rusklite

- **hindsight-git**: library crate that processes git logs for hindsight-mcp (used by hindsight-mcp crate)
	- git2-rs

- **hindsight-tests**: library crate that processes test logs for hindsight-mcp (used by hindsight-mcp crate)
	- cargo-nextest
	- nextest-metadata (for parsing cargo-nextest output)

- **hindsight-copilot**: library crate that processes GitHub copilot logs for hindsight-mcp (used by hindsight-mcp crate)
	- refer notes section below for the hindsight-copilot dependencies

### cargo workspace dependencies

[workspace.dependencies]
thiserror = "2.0.17"
criterion = "0.8.1"
proptest = "1.9.0"
similar = "2.7.0"
similar-asserts = "1.7.0"
chrono = "0.4.43"
# Structured logging/tracing for debugging
tracing = "0.1.44"
tracing-subscriber = { version = "0.3.22", features = ["env-filter"] }
serde_json = "1.0.149"


### notes (dependencies for the hindsight-copilot library crate)

While there isn't a single "standard" crate specifically named for parsing GitHub Copilot logs, the logs themselves follow a standard **JSON Stream** or **LSP (Language Server Protocol) Trace** format.

#### 1. `serde_json` (The Critical Foundation)

GitHub Copilot logs are typically JSON-serialized. If you set your log level to `Trace` in VS Code, Copilot outputs detailed JSON objects representing the requests and responses between the IDE and the Copilot server.

* **Why use it:** It's the gold standard for performance. Using the `StreamDeserializer`, you can parse logs in real-time as they are written to the VS Code output channel without loading the entire file into memory.
* **Crate Name:** `serde_json`

#### 2. `lsp-types`

Since GitHub Copilot operates as a Language Server, much of its log data follows the **Language Server Protocol (LSP)**.

* **Key Use Case:** If you are trying to understand the *context* Copilot is sending (like the specific code snippets or "ghost text" suggestions), this crate provides the type definitions for `Position`, `Range`, and `TextDocument`.
* **Benefit:** It saves you from manually defining the complex structures used in IDE-to-AI communication.
* **Crate Name:** `lsp-types`

#### 3. `tracing-subscriber` & `tracing-serde`

Injesting logs:

* **Use Case:** These crates allow you to take structured JSON logs and "re-hydrate" them into a live trace tree. 
* **Crate Name:** `tracing-subscriber`


----- 
In VS Code, GitHub Copilot sessions are **automatically saved locally**, but they are managed differently depending on whether you are using the standard "Chat" view or the "Editor" view.

Here is exactly how and where those sessions are logged:

Where are they saved? (Local Storage)

VS Code stores your chat history in a local SQLite database and JSON files. This is why you can see "Recent" chats even after restarting the IDE.

* **Windows:** `%APPDATA%\Code\User\workspaceStorage\<workspace-id>\chatSessions\`
* **macOS:** `~/Library/Application Support/Code/User/workspaceStorage/<workspace-id>/chatSessions/`
* **Linux:** `~/.config/Code/User/workspaceStorage/<workspace-id>/chatSessions/`

> [!IMPORTANT]
> **Workspace Binding:** These logs are usually tied to a specific "Workspace." If you open a single file without a folder, or move your project to a new directory, the history might appear "lost" because the ID has changed.

**Copilot Agents** (like `@workspace`).

* These sessions generate **detailed execution logs**. 
---

